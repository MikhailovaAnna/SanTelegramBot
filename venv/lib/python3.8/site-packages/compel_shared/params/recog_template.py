from dataclasses import field
from marshmallow_dataclass import dataclass

from compel_shared import load_yml
from compel_shared.params import load_template_config_defaults
from compel_shared.params.param import TemplatesConfig
from compel_shared.schema import MongoIDSchema, pick_field_data


@dataclass(base_schema=MongoIDSchema)
class RecogTemplate(TemplatesConfig):
    id: str = field(default=None, metadata=pick_field_data(MongoIDSchema, 'id', data_key='_id'))
    name: str = field(
        default=None, metadata=dict(title='Название',
                                    description='Название шаблона',
                                    required_on_create=True))
    description: str = field(
        default=None, metadata=dict(title='Описание', as_textarea=True))
    sample_string: str = field(
        default=None, metadata=dict(title='Пример строки'))
    provider: str = field(
        default=None, metadata=dict(title='Поставщик', is_hidden=True))

    @staticmethod
    def load_defaults():
        data = load_yml(__file__, 'recog_templates.yml')
        return load_template_config_defaults(data)
