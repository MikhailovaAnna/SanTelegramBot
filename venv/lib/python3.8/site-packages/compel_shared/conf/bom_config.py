from dataclasses import field

from marshmallow_dataclass import dataclass

from compel_shared.conf import ConfigElement
from compel_shared.conf.search_config import SearchConfig
from compel_shared.schema import OrderedSchema
from compel_shared.schema import pick_field


@dataclass(base_schema=OrderedSchema)
class BomConfig(ConfigElement):
    batch_size: int = field(default=250, metadata=dict(
        title='Макс. кол-во запросов в одном пакете',
        schema={'minimum': 0},
    ))
    limit: int = field(default=2000, metadata=dict(
        marshmallow_field=pick_field(SearchConfig.Schema, 'limit')))
    report_min_score: int = field(default=60, metadata=dict(
        title='Порог релевантности для репорта',
        description='Порог релевантности, ниже которого строки автоматически добавляются в набор нераспознанных строк',
        schema={'minimum': 0, 'maximum': 100}))
