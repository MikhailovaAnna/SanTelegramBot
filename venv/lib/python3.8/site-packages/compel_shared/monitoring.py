from hr_prometheus.monitors import RequestMonitor
from prometheus_client.metrics import Gauge

import versioneer
from compel_shared import __version__ as shared_version


class ServiceRequestMonitor(RequestMonitor):

    VERSION = Gauge(
        "version", "Service Version", ["service", "shared"]
    )

    def update_end_metrics(self):
        super().update_end_metrics()
        self.VERSION.labels(versioneer.get_version(), shared_version).set(1)
